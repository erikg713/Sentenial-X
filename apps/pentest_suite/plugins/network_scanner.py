# pentest_suite/plugins/network_scanner.py
import socket

class NetworkScannerPlugin:
    """
    Simple IP/port scanning plugin.
    """

    def __init__(self):
        self.name = "NetworkScanner"
        self.description = "Scans IP addresses and ports for open services"

    def execute(self, target_ip: str, ports: list = [22, 80, 443]):
        results = {}
        for port in ports:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sock.settimeout(1)
            try:
                sock.connect((target_ip, port))
                results[port] = "open"
            except Exception:
                results[port] = "closed"
            finally:
                sock.close()
        return results
