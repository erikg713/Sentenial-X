# pentest_suite/plugins/web_exploit.py
import requests

class WebExploitPlugin:
    """
    Example plugin for automated XSS/SQLi detection.
    """

    def __init__(self):
        self.name = "WebExploit"
        self.description = "Performs basic XSS/SQLi detection on URLs"

    def execute(self, target_url: str):
        payloads = ["<script>alert(1)</script>", "' OR '1'='1"]
        results = []
        for p in payloads:
            try:
                r = requests.get(target_url, params={"input": p}, timeout=3)
                if p in r.text:
                    results.append({"payload": p, "vulnerable": True})
                else:
                    results.append({"payload": p, "vulnerable": False})
            except Exception as e:
                results.append({"payload": p, "error": str(e)})
        return results
