# apps/dashboard/services/exploit_monitor.py
from apps.dashboard.pages.widgets.exploit_log import ExploitLogWidget
import random

class ExploitMonitor:
    def __init__(self):
        self.widget = ExploitLogWidget()

    async def simulate_exploits(self):
        exploits = ["CVE-2021-34527", "MS17-010", "Struts-RCE"]
        agents = [f"agent-{i}" for i in range(1,6)]
        for agent in agents:
            exploit = random.choice(exploits)
            status = random.choice(["success", "blocked", "detected"])
            self.widget.add_log(agent, exploit, status)
        await asyncio.sleep(12)
