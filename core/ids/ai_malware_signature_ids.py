[
  {
    "id": "IDS-1001",
    "name": "Suspicious PowerShell Execution",
    "description": "Detects obfuscated or encoded PowerShell commands often used in attacks.",
    "severity": "High",
    "category": "Execution",
    "pattern_type": "regex",
    "pattern": "(?i)powershell.*-enc.*[A-Za-z0-9+/]{100,}",
    "tags": ["powershell", "obfuscation", "script"]
  },
  {
    "id": "IDS-1002",
    "name": "Credential Dumping via LSASS",
    "description": "Detection of attempts to access LSASS memory via common tools like Mimikatz.",
    "severity": "Critical",
    "category": "Credential Access",
    "pattern_type": "contains",
    "pattern": "lsass.exe",
    "tags": ["mimikatz", "creds", "lsass"]
  },
  {
    "id": "IDS-1003",
    "name": "Remote Command Execution Over SMB",
    "description": "Looks for psexec-style command execution on remote hosts.",
    "severity": "High",
    "category": "Lateral Movement",
    "pattern_type": "regex",
    "pattern": "(?i)psexec.*\\\\\\\\[a-zA-Z0-9_-]+\\\\admin",
    "tags": ["psexec", "remote", "smb"]
  },
  {
    "id": "IDS-1004",
    "name": "Data Exfiltration Over DNS",
    "description": "Monitors for base64 or hex data exfiltration in DNS queries.",
    "severity": "Medium",
    "category": "Exfiltration",
    "pattern_type": "regex",
    "pattern": "([A-Za-z0-9+/=]{40,})\\.example\\.com",
    "tags": ["dns", "exfil", "covert"]
  },
  {
    "id": "IDS-1005",
    "name": "Persistence via Registry Run Key",
    "description": "Detects addition of registry keys under Run or RunOnce.",
    "severity": "Medium",
    "category": "Persistence",
    "pattern_type": "contains",
    "pattern": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
    "tags": ["registry", "persistence"]
  },
  {
    "id": "IDS-1006",
    "name": "Webshell Detected",
    "description": "Command-line arguments or uploads resembling known ASPX/PHP/JS webshells.",
    "severity": "High",
    "category": "Webshell",
    "pattern_type": "regex",
    "pattern": "(?i)(cmd\\.exe|powershell|eval\\(|base64_decode)",
    "tags": ["webshell", "php", "asp", "eval"]
  }
]
