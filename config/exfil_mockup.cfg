; ===============================================================
; Simulated exfiltration scenario configuration
; - PURPOSE: safe, auditable simulation for testing detection & response.
; - IMPORTANT: This file is intended for authorized, controlled test
;   environments only. Do NOT use against systems you do not own or
;   have explicit permission to test. Keep keys out of the repository.
; ===============================================================

[general]
scenario_id = EXFIL-SIM-2025-07
description = Controlled simulation of multi-channel data exfiltration for detection testing
enabled = true
simulation_mode = true         ; true = no live-data transfer unless explicitly disabled
consent_confirmed = false      ; MUST be set to true and documented before running against real targets
approval_ticket =              ; internal ticket/PR that authorizes this test (required in production)
repeat = false
delay_between_stages_seconds = 5
jitter = 0.10                  ; randomize delays up to +/-10% to avoid perfectly deterministic timing
max_runtime_seconds = 3600

[target]
; Use test / reserved addresses and domains by default. Replace only with approved targets.
destination_ips = 198.51.100.42
destination_domains = staging.exfil-mock.io, backup.exfil-mock.io
protocols = http, https, dns, smtp
ports = 80, 443, 53, 587
allow_live_network = false     ; prevents accidental use of production networks during simulation

[data_payload]
type = file
file_path = /tmp/fake_hr_data.csv
file_size_kb = 250
encoding = base64
chunk_size_kb = 50
compress = true
checksum_algorithm = sha256
checksum =                      ; leave blank to compute at runtime
max_chunk_retries = 3

[http_exfil]
enabled = true
method = POST
endpoint = /upload.php
headers = User-Agent: Mozilla/5.0 (compatible), Content-Type: application/json
use_tls = true
validate_server_cert = true
timeout_seconds = 30
retry_policy = exponential_backoff
max_retries = 3
backoff_initial_seconds = 2
backoff_max_seconds = 60

[dns_exfil]
enabled = true
max_label_length = 50
domain_suffix = exfil-mock.io
encoding_scheme = base32hex    ; recommended for DNS-safe labels
send_interval_seconds = 2
use_dns_over_https = false
doh_endpoint = https://dns.example/dns-query

[smtp_exfil]
enabled = false
recipient = attacker@exfil-mock.io
sender = no-reply@staging.exfil-mock.io
subject = Q3 status report
body_template = Please find the attached.
use_tls = true
smtp_auth = false
smtp_username =
smtp_password_source = env:SMTP_PASSWORD

[encryption]
enabled = true
method = aes-256-cbc
key_source = env:EXFIL_KEY      ; DO NOT commit keys to repo â€” use environment or KMS
iv_source = env:EXFIL_IV
key_rotation_interval_days = 30
authenticated_encryption = true ; prefer AEAD modes if available (e.g., AES-GCM)

[cleanup]
delete_payload = true
log_exfil_attempt = true
log_level = INFO
retain_logs_days = 90
wipe_method = shred             ; options: shred, zero, overwrite

[audit]
enable_audit = true
audit_output = logs/exfil_simulation.log
redact_sensitive = true         ; redact PII and secrets from logs
include_metadata = true

[safety]
required_environments = staging, sandbox, ci
block_production = true
required_approvals = 1
approval_notes = Simulation requires documented authorization and consent_confirmed=true

; ----------------------------------------------------------------
; Notes:
; - Replace environment-derived secrets (EXFIL_KEY, EXFIL_IV, SMTP_PASSWORD)
;   via CI/CD or a secrets manager. Do not hardcode secrets here.
; - Keep simulation_mode=true and allow_live_network=false for development.
; - Toggle consent_confirmed=true and update approval_ticket when authorized.
; - This configuration is versioned and intended for lawful testing only.
; ----------------------------------------------------------------
[encryption]
enabled = true
method = aes-256
key = mocktestkey1234567890123456
iv = 0102030405060708

[cleanup]
delete_payload = true
log_exfil_attempt = true
